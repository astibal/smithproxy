settings = {
    certs_path = "../certs/";
    certs_ca_key_password = "fortinet"
    plaintext_port = 50080;
    ssl_port = 50443;    
}

address_objects = {
    any = {
        mode = 0;
        cidr = "0.0.0.0/0";
    }
}

port_objects = {
    all = {
        start = 0;
        end = 65535;
    }
}

proto_objects = {
    tcp = {
        id = 6;
    }
}

detection_profiles = (
    {
        name = "default";
        mode = 0;
    },
    {
        name = "detect";
        mode = 2;
    }
)

content_profiles = (
    {
        name = "default";
        write_payload = FALSE;
        write_limit_client = 0;
        write_limit_server = 0;
    }
)

policy = (
    {
        proto = "tcp";
        src = "any";
        sport = "all";
        dst = "any";
        dport = "all";
        detection_profile = "default";
        content_profile = "default";
    }
)


starttls_signatures = (
    {
        cat  = "mail";
        name = "smtp/starttls";
        side = "client";
        flow = (
            {
                side = "r";
                type = "regex";
                signature = "^STARTTLS";
                bytes_start = 0;
                bytes_max = 16;
            },
            {
                side = "w";
                type = "regex";
                signature = "^2[0-5]0 ";
                bytes_start = 0;
                bytes_max = 16;
            }
        )
    },
    {
        cat  = "mail";
        name = "imap/starttls";
        side = "client";
        flow = (
            {
                side = "r";
                type = "regex";
                signature = ". STARTTLS\r\n";
                bytes_start = 0;
                bytes_max = 16;
            },
            {
                side = "w";
                type = "regex";
                signature = ". OK";
                bytes_start = 0;
                bytes_max = 64;
            }
        )
    },
    {
        cat  = "mail";    
        name = "pop3/starttls";
        side = "client";
        flow = (
            {
                side = "r";
                type = "regex";
                signature = "^STLS\r\n";
                bytes_start = 0;
                bytes_max = 10;
            },
            {
                side = "w";
                type = "regex";
                signature = "^[+]OK";
                bytes_start = 0;
                bytes_max = 5;
            }
        )
    },
    {
        cat  = "file";
        name = "ftp/starttls";
        side = "client";
        flow = (
            {
                side = "r";
                type = "regex";
                signature = "^AUTH TLS\r\n";
                bytes_start = 0;
                bytes_max = 10;
            },
            {
                side = "w";
                type = "regex";
                signature = "^[2][0-9][0-9] AUTH";
                bytes_start = 0;
                bytes_max = 5;
            }
        )
    },
    {
        cat  = "im";    
        name = "xmpp/starttls";
        side = "client";
        flow = (
            {
                side = "r";
                type = "regex";
                signature = "^<starttls [^>/]+xmpp-tls[^>/]/>";
                bytes_start = 0;
                bytes_max = 64;
            },
            {
                side = "w";
                type = "regex";
                signature = "^<proceed [^>/]+xmpp-tls[^>/]/>";
                bytes_start = 0;
                bytes_max = 64;
            }
        )
    }    
)

detection_signatures = (
    {
        cat  = "www";    
        name = "http/get|post";
        side = "client";
        flow = (
            {
                side = "r";
                type = "regex";
                signature = "^(GET|POST) +([^ ]+)";
                bytes_start = 0;
                bytes_max = 64;
            },
            {
                side = "w";
                type = "regex";
                signature = "HTTP/1.[01] +([1-5][0-9][0-9]) ";
                bytes_start = 0;
                bytes_max = 64;
            }
        )
    },
    {
        cat  = "av";
        name = "virus/eicar";
        side = "client";
        flow = (
            {
                side = "w";
                type = "simple";
                signature = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*";
                bytes_start = 0;
                bytes_max = 0;
            }
        )
    }    
)